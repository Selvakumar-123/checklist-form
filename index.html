<!DOCTYPE html>
<html>
<head>
  <title>MEWP Checklist</title>
  <style>
body {
  font-family: sans-serif;
  margin: 20px; /* Add some margin around the page */
}

h2 {
  text-align: padding-left; /* Center the main heading */
  margin-bottom: 20px;
}
    .take-note {
      margin-bottom: 20px;
      border: 1px solid #ccc;
      padding: 10px;
    }

    .take-note ol {
      margin: 0; /* Remove default margin */
      padding-left: 20px; /* Adjust for list numbers */
    }

    .take-note li {
      text-align: left; /* Align text to the left */
      margin-bottom: 5px;
    }


table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 20px;
}

th,
td {
  border: 1px solid black;
  padding: 8px;
  text-align: left;
}

th {
  background-color: #f2f2f2; /* Light gray background for header cells */
  font-weight: bold;
}

/* Zebra striping for table rows */
tbody tr:nth-child(even) {
  background-color: #f8f8f8; /* Slightly darker gray for even rows */
}

/* Category styling */
td[rowspan] {
  font-weight: bold;
  background-color: #e6e6e6; /* Light gray background for category cells */
}

/* Checkbox styling */
input[type="checkbox"] {
  margin: 0; /* Remove default margin */
  width: 18px; /* Set checkbox size */
  height: 18px;
}

/* Remarks input field styling */
input[type="text"] {
  width: 95%;
  padding: 5px;
  border: 1px solid #ccc;
}

/* Operator, Company, and Signature section */
.form-section {
  margin-bottom: 20px;
}

.form-section label {
  display: block; /* Labels on their own line */
  margin-bottom: 5px;
  font-weight: bold;
}

.form-section input[type="text"] {
  width: 300px;
  padding: 5px;
  border: 1px solid #ccc;
  margin-bottom: 10px;
}

/* Signature pad */
.signature-pad {
  border: 1px solid black;
}

/* Clear button */
#clearSignature {
  margin-top: 5px;
  padding: 5px 10px;
  background-color: #eee;
  border: 1px solid #ccc;
  cursor: pointer;
}

/* Submit button */
button[type="submit"] {
  padding: 10px 20px;
  background-color: #4CAF50; /* Green submit button */
  color: white;
  border: none;
  cursor: pointer;
  font-weight: bold;
}
  </style>
  <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
</head>
<body>

  <h1>Boomlift Daily Checklist</h1>
  <h2>Take note !! </h2>
  <h2>
  1.Only trained and certified operators should use a boom lift.
  
  2.Wear hard hats, full-body safety harnesses, and non-slip footwear.
  
  3.Always attach your safety harness to designated anchor points.
  
  4.Operate on stable and even surfaces.
  
  5.Check for power lines, ceilings, beams, or tree branches.

  6.Don't left key on boomlift  , no use return to security guard .
  
  7.Failed to return / loss of key , clean platform on the day of work $50 admin fees will be issued .
  
  </h2>
  <canvas> </canvas>
  <form id="checklistForm">
    <table>
      <thead>
        <tr>
          <th>Category</th>
          <th>Item</th>
          <th>OK</th>
          <th>Not OK</th>
          <th>Remarks</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td rowspan="5">1. Structure</td>
          <td>Chassis</td>
          <td><input type="checkbox" name="chassis_ok"></td>
          <td><input type="checkbox" name="chassis_not_ok"></td>
          <td><input type="text" name="chassis_remarks"></td>
        </tr>
        <tr>
          <td>Boom</td>
          <td><input type="checkbox" name="boom_ok"></td>
          <td><input type="checkbox" name="boom_not_ok"></td>
          <td><input type="text" name="boom_remarks"></td>
        </tr>
        <tr>
          <td>Axle</td>
          <td><input type="checkbox" name="axle_ok"></td>
          <td><input type="checkbox" name="axle_not_ok"></td>
          <td><input type="text" name="axle_remarks"></td>
        </tr>
        <tr>
          <td>Turn table</td>
          <td><input type="checkbox" name="turntable_ok"></td>
          <td><input type="checkbox" name="turntable_not_ok"></td>
          <td><input type="text" name="turntable_remarks"></td>
        </tr>
        <tr>
          <td>Platform</td>
          <td><input type="checkbox" name="platform_ok"></td>
          <td><input type="checkbox" name="platform_not_ok"></td>
          <td><input type="text" name="platform_remarks"></td>
        </tr>

        <tr>
          <td rowspan="6">2. Engine</td>
          <td>Start-stop operation</td>
          <td><input type="checkbox" name="startstop_ok"></td>
          <td><input type="checkbox" name="startstop_not_ok"></td>
          <td><input type="text" name="startstop_remarks"></td>
        </tr>
        <tr>
          <td>Engine oil level</td>
          <td><input type="checkbox" name="engineoil_ok"></td>
          <td><input type="checkbox" name="engineoil_not_ok"></td>
          <td><input type="text" name="engineoil_remarks"></td>
        </tr>
        <tr>
          <td>Engine fan belt</td>
          <td><input type="checkbox" name="fanbelt_ok"></td>
          <td><input type="checkbox" name="fanbelt_not_ok"></td>
          <td><input type="text" name="fanbelt_remarks"></td>
        </tr>
        <tr>
          <td>Radiator water level</td>
          <td><input type="checkbox" name="radiatorwater_ok"></td>
          <td><input type="checkbox" name="radiatorwater_not_ok"></td>
          <td><input type="text" name="radiatorwater_remarks"></td>
        </tr>
        <tr>
          <td>Oil leakage</td>
          <td><input type="checkbox" name="engineoilleak_ok"></td>
          <td><input type="checkbox" name="engineoilleak_not_ok"></td>
          <td><input type="text" name="engineoilleak_remarks"></td>
        </tr>
        <tr>
          <td>Exhaust</td>
          <td><input type="checkbox" name="exhaust_ok"></td>
          <td><input type="checkbox" name="exhaust_not_ok"></td>
          <td><input type="text" name="exhaust_remarks"></td>
        </tr>

        <tr>
          <td rowspan="3">3. Hydraulic</td>
          <td>Oil level</td>
          <td><input type="checkbox" name="hydoil_ok"></td>
          <td><input type="checkbox" name="hydoil_not_ok"></td>
          <td><input type="text" name="hydoil_remarks"></td>
        </tr>
        <tr>
          <td>Oil Leakage</td>
          <td><input type="checkbox" name="hydoilleak_ok"></td>
          <td><input type="checkbox" name="hydoilleak_not_ok"></td>
          <td><input type="text" name="hydoilleak_remarks"></td>
        </tr>
        <tr>
          <td>Hose condition</td>
          <td><input type="checkbox" name="hose_ok"></td>
          <td><input type="checkbox" name="hose_not_ok"></td>
          <td><input type="text" name="hose_remarks"></td>
        </tr>

        <tr>
          <td rowspan="5">4. Electrical System</td>
          <td>Ground/Platform station</td>
          <td><input type="checkbox" name="groundplatform_ok"></td>
          <td><input type="checkbox" name="groundplatform_not_ok"></td>
          <td><input type="text" name="groundplatform_remarks"></td>
        </tr>
        <tr>
          <td>Emergency stop / circuit</td>
          <td><input type="checkbox" name="emergencystop_ok"></td>
          <td><input type="checkbox" name="emergencystop_not_ok"></td>
          <td><input type="text" name="emergencystop_remarks"></td>
        </tr>
        <tr>
          <td>Foot switch</td>
          <td><input type="checkbox" name="footswitch_ok"></td>
          <td><input type="checkbox" name="footswitch_not_ok"></td>
          <td><input type="text" name="footswitch_remarks"></td>
        </tr>
        <tr>
          <td>Wiring condition</td>
          <td><input type="checkbox" name="wiring_ok"></td>
          <td><input type="checkbox" name="wiring_not_ok"></td>
          <td><input type="text" name="wiring_remarks"></td>
        </tr>
        <tr>
          <td>Battery connection</td>
          <td><input type="checkbox" name="battery_ok"></td>
          <td><input type="checkbox" name="battery_not_ok"></td>
          <td><input type="text" name="battery_remarks"></td>
        </tr>

        <tr>
          <td rowspan="4">5. Operation Test</td>
          <td>Travelling</td>
          <td><input type="checkbox" name="travelling_ok"></td>
          <td><input type="checkbox" name="travelling_not_ok"></td>
          <td><input type="text" name="travelling_remarks"></td>
        </tr>
        <tr>
          <td>Swing</td>
          <td><input type="checkbox" name="swing_ok"></td>
          <td><input type="checkbox" name="swing_not_ok"></td>
          <td><input type="text" name="swing_remarks"></td>
        </tr>
        <tr>
          <td>Boom up and down</td>
          <td><input type="checkbox" name="boomupdown_ok"></td>
          <td><input type="checkbox" name="boomupdown_not_ok"></td>
          <td><input type="text" name="boomupdown_remarks"></td>
        </tr>
        <tr>
          <td>Tele in and out</td>
          <td><input type="checkbox" name="tele_ok"></td>
          <td><input type="checkbox" name="tele_not_ok"></td>
          <td><input type="text" name="tele_remarks"></td>
        </tr>

        <tr>
          <td rowspan="6">6. Cleanliness & Safety Guard</td>
          <td>Body</td>
          <td><input type="checkbox" name="body_ok"></td>
          <td><input type="checkbox" name="body_not_ok"></td>
          <td><input type="text" name="body_remarks"></td>
        </tr>
        <tr>
          <td>Radiator</td>
          <td><input type="checkbox" name="radiator_ok"></td>
          <td><input type="checkbox" name="radiator_not_ok"></td>
          <td><input type="text" name="radiator_remarks"></td>
        </tr>
        <tr>
          <td>Overhead Guard</td>
          <td><input type="checkbox" name="overheadguard_ok"></td>
          <td><input type="checkbox" name="overheadguard_not_ok"></td>
          <td><input type="text" name="overheadguard_remarks"></td>
        </tr>
        <tr>
          <td>Overhead Guard Clamp</td>
          <td><input type="checkbox" name="overheadclamp_ok"></td>
          <td><input type="checkbox" name="overheadclamp_not_ok"></td>
          <td><input type="text" name="overheadclamp_remarks"></td>
        </tr>
        <tr>
          <td>Hyd. Tank Safety Cover</td>
          <td><input type="checkbox" name="hydtank_ok"></td>
          <td><input type="checkbox" name="hydtank_not_ok"></td>
          <td><input type="text" name="hydtank_remarks"></td>
        </tr>
        <tr>
          <td>Platform Hand Guard</td>
          <td><input type="checkbox" name="platformhandguard_ok"></td>
          <td><input type="checkbox" name="platformhandguard_not_ok"></td>
          <td><input type="text" name="platformhandguard_remarks"></td>
        </tr>
      </tbody>
    </table>

    <div>
      <label for="operatorName">Operator Name:</label>
      <input type="text" id="operatorName" name="operatorName"  required>
    </div>
    
    <div>
      <label for="companyName">Company Name:</label>
      <input type="text" id="companyName" name="companyName"  required>
    </div>
    
    <div>
      <label for="signature">Signature:</label>
      <canvas id="signature" class="signature-pad" width="400" height="200"></canvas>
      <input type="hidden" id="signatureData" name="signatureData"  required>
      <button type="button" id="clearSignature">Clear</button>
    </div>
   
    <button type="submit">Submit</button>
  </form>

  <script>
    // Initialize Signature Pad
    const canvas = document.getElementById('signature');
    const signaturePad = new SignaturePad(canvas);

    document.getElementById('clearSignature').addEventListener('click', () => {
      signaturePad.clear();
    });

    // Handle Form Submission
    const form = document.getElementById('checklistForm');
    form.addEventListener('submit', (event) => {
      event.preventDefault();

      // Get signature data
      const signatureData = signaturePad.toDataURL();
      document.getElementById('signatureData').value = signatureData;

      // Collect form data
      const formData = new FormData(form);
      const data = {};
      for (const [key, value] of formData) {
        data[key] = value;
      }

      // Prepare data for Google Apps Script
      const scriptURL = 'https://script.google.com/macros/s/AKfycbxoM_sfPySCsBcbpbWBPFk6Qr9llLQCjVXSU8go6eIXDlfbbDlGgljLQH6nwlm9ALC2/exec'; // Replace with your script URL

      // Send data to Google Apps Script
      fetch(scriptURL, {
        method: 'POST',
        mode: 'no-cors', // Important for sending data to Apps Script
        body: JSON.stringify(data),
      })
      .then(response => {
        console.log('Success!', response);
        alert('Form submitted successfully!');
        form.reset();
        signaturePad.clear();
      })
      .catch(error => {
        console.error('Error!', error.message);
        alert('Error submitting form. Please try again.');
      });
    });
    
    function doPost(e) {
  // Get the spreadsheet and sheet
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const sheet = ss.getSheetByName("sheet1"); // Change "Sheet1" to your sheet name

  // Parse the incoming data
  const data = JSON.parse(e.postData.contents);

  // Create a new row with the data
  const newRow = [];

  // Add data in the desired order
  const headers = [
    'Timestamp', 'Operator Name', 'Company Name', 'Signature',
    'chassis_ok', 'chassis_not_ok', 'chassis_remarks',
    'boom_ok', 'boom_not_ok', 'boom_remarks',
    'axle_ok', 'axle_not_ok', 'axle_remarks',
    'turntable_ok', 'turntable_not_ok', 'turntable_remarks',
    'platform_ok', 'platform_not_ok', 'platform_remarks',
    'startstop_ok', 'startstop_not_ok', 'startstop_remarks',
    'engineoil_ok', 'engineoil_not_ok', 'engineoil_remarks',
    'fanbelt_ok', 'fanbelt_not_ok', 'fanbelt_remarks',
    'radiatorwater_ok', 'radiatorwater_not_ok', 'radiatorwater_remarks',
    'engineoilleak_ok', 'engineoilleak_not_ok', 'engineoilleak_remarks',
    'exhaust_ok', 'exhaust_not_ok', 'exhaust_remarks',
    'hydoil_ok', 'hydoil_not_ok', 'hydoil_remarks',
    'hydoilleak_ok', 'hydoilleak_not_ok', 'hydoilleak_remarks',
    'hose_ok', 'hose_not_ok', 'hose_remarks',
    'groundplatform_ok', 'groundplatform_not_ok', 'groundplatform_remarks',
    'emergencystop_ok', 'emergencystop_not_ok', 'emergencystop_remarks',
    'footswitch_ok', 'footswitch_not_ok', 'footswitch_remarks',
    'wiring_ok', 'wiring_not_ok', 'wiring_remarks',
    'battery_ok', 'battery_not_ok', 'battery_remarks',
    'travelling_ok', 'travelling_not_ok', 'travelling_remarks',
    'swing_ok', 'swing_not_ok', 'swing_remarks',
    'boomupdown_ok', 'boomupdown_not_ok', 'boomupdown_remarks',
    'tele_ok', 'tele_not_ok', 'tele_remarks',
    'body_ok', 'body_not_ok', 'body_remarks',
    'radiator_ok', 'radiator_not_ok', 'radiator_remarks',
    'overheadguard_ok', 'overheadguard_not_ok', 'overheadguard_remarks',
    'overheadclamp_ok', 'overheadclamp_not_ok', 'overheadclamp_remarks',
    'hydtank_ok', 'hydtank_not_ok', 'hydtank_remarks',
    'platformhandguard_ok', 'platformhandguard_not_ok', 'platformhandguard_remarks'
  ];
  
  // Add timestamp as the first element
  newRow.push(new Date());

  // Add operator name, company name, and signature
  newRow.push(data['operatorName'] || '');
  newRow.push(data['companyName'] || '');
  newRow.push(data['signatureData'] || '');

  // Loop through the headers and add data to the new row
  for (let i = 4; i < headers.length; i++) {
      const header = headers[i];
      newRow.push(data[header] || '');
  }
  // Append the new row to the sheet
  sheet.appendRow(newRow);

  return ContentService.createTextOutput(JSON.stringify({ "result": "success" }))
    .setMimeType(ContentService.MimeType.JSON);
}
    
  </script>

</body>
</html>
